# Online Change Point Detection for Bimodal Time Series

This repository contains the R code for the master's thesis, "Online change point detection under a Copula-based Markov Chain Model for Bimodal Time Series". The project implements a Bayesian Online Changepoint Detection (BOCD) algorithm tailored for time series data exhibiting bimodal distributions and serial dependence, modeled via a Clayton copula.

## Project Structure

-   `/R`: Contains all core R functions for the analysis.
    -   `01_bocd_core.R`: The main logic for the Bayesian Online Changepoint Detection algorithm.
    -   `02_posterior_predictive.R`: Functions to compute the posterior predictive distribution using MCMC for different model specifications.
    -   `03_data_generators.R`: Functions to generate synthetic time series data with specified changepoints for simulation studies.
    -   `04_evaluation_metrics.R`: Functions to calculate performance metrics like Precision, MAE, ADD, etc.
    -   `05_utils.R`: Utility functions, including the Clayton copula density and normal mixture model distributions (pdf, cdf, quantile).
-   `/simulations`: Scripts to run the simulation studies described in the thesis.
    -   `run_simulation_study.R`: The main script to configure and execute a simulation case.
-   `/empirical_analysis`: Scripts to perform the analysis on real-world cryptocurrency data.
    -   `run_empirical_analysis.R`: The main script to fetch crypto data and apply the BOCD algorithm.
-   `/results`: Default output directory for plots and CSV files generated by the scripts.

## Requirements

You will need the following R packages. You can install them using `install.packages()`.

```R
install.packages(c("magrittr", "truncnorm", "LaplacesDemon", "HDInterval", "doSNOW", "snow", "parallel", "mixtools", "geckor", "zoo"))
```

## How to Run

### 1. Simulation Study

To replicate the simulation results from the thesis:
1.  Navigate to the `simulations/` directory.
2.  Open the `run_simulation_study.R` script.
3.  Modify the "Simulation Configuration" section to match the case and scenario you wish to test (e.g., change `PARAMS1`, `PARAMS2`, `TRUE_CP`, etc.).
4.  Run the script in R or RStudio.
5.  Results (raw run lengths, a summary table, and a median run length plot) will be saved to the `results/simulations/` directory.

### 2. Empirical Analysis

To replicate the analysis on cryptocurrency data:
1.  Navigate to the `empirical_analysis/` directory.
2.  Open the `run_empirical_analysis.R` script.
3.  The script contains pre-configured calls to the `analyze_crypto` function for different cases (e.g., ETH ICO Boom, BTC ICO Bust).
4.  You can modify these calls or add new ones to analyze different coins, time periods, or model configurations.
5.  Run the script.
6.  A set of plots (log return, run length, and price) for each analysis will be saved to the `results/empirical/` directory.
